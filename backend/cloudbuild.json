{
  "steps": [
    {
      "name": "gcr.io/kaniko-project/executor:latest",
      "id": "agent",
      "args": [
        "--dockerfile=backend/Dockerfile",
        "--context=/workspace",
        "--destination=gcr.io/prouml/agent:$SHORT_SHA",
        "--build-arg=SHORT_SHA=$SHORT_SHA",
        "--cache=true",
        "--cache-ttl=5h"
      ]
    },
    {
      "name": "gcr.io/google.com/cloudsdktool/cloud-sdk",
      "entrypoint": "bash",
      "args": ["-c", "gcloud config set app/cloud_build_timeout 1600 && gcloud app deploy"]
    }
  ],
  "timeout": "1600s"
}
